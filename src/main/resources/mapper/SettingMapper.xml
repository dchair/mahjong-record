<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace ="chair.mahjong_record.mapper.SettingMapper">
    <select id="getSettingById" parameterType="int" resultType="chair.mahjong_record.model.GameSetting">
        SELECT *
        FROM
            game_settings
        WHERE
            setting_id = #{settingId}
    </select>

    <insert id="createSetting" parameterType="chair.mahjong_record.dto.GameSettingRequest"
            useGeneratedKeys="true" keyProperty="settingId">
    INSERT INTO game_settings (base_fan_price, per_fan_price, created_date, last_modified_date)
    VALUES (#{baseFanPrice}, #{perFanPrice}, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
    </insert>

    <select id="getSettings" parameterType="map"
            resultType="chair.mahjong_record.model.GameSetting">
        SELECT *
        FROM game_settings
        ORDER BY
            <choose>
                <when test="orderBy != null and orderBy != ''">
                    ${orderBy}
                </when>
                <otherwise>
                    setting_id
                </otherwise>
            </choose>
            <choose>
                <when test="sort !=null and sort !=''">
                    ${sort}
                </when>
                <otherwise>
                    ASC
                </otherwise>
            </choose>
        LIMIT #{limit}
        OFFSET #{offset}
    </select>

    <select id="countSettings" resultType="int">
        SELECT COUNT(*) FROM game_settings
    </select>

</mapper>